$((function(){$("#form").hide(),e();let t=!1;function e(){$.ajax({url:"http://127.0.0.1:3000/api/clientes",type:"GET",success:function(t){let e=JSON.parse(t),n="";e.forEach(t=>{n+=`\n                    <tr clienteId="${t.id}">\n                        <td class="text-center">${t.id}</td>\n                        <td class="text-center">${t.nombre}</td>\n                        <td class="text-center">${t.apellido}</td>\n                        <td class="text-center">${t.domicilio}</td>\n                        <td class="text-center">${t.correo}</td>\n                        <td class="d-flex justify-content-around">\n                            <button class="btn btn-warning" id="btnActualizar">Actualizar</button>\n                            <button class="btn btn-danger" id="btnEliminar">Eliminar</button>\n                        </td>\n                    </tr>\n                `}),$("#clientes").html(n)}})}$("#alertaCliente").hide(),$("#btnAgregar").click(()=>{$("#btnAgregar").hide(),$("#form").show(),$("#formTitle").text("Agregar Cliente"),$("#btnAddUpd").text("Agregar")}),$("#btnCancelar").click(()=>{$("#form").hide(),$("#form").trigger("reset"),$("#btnAgregar").show()}),$("#buscar").keyup(()=>{if($("#buscar").val()){let t=$("#buscar").val();$.ajax({url:"http://127.0.0.1:3000/api/buscar",data:{buscar:t},type:"POST",success:function(t){if(!t.error){let e=JSON.parse(t),n="";e.forEach(t=>{n+=`\n\t\t\t\t\t\t\t\t<tr clienteId="${t.id}">\n\t\t\t\t\t\t\t\t\t<td class="text-center">${t.id}</td>\n\t\t\t\t\t\t\t\t\t<td class="text-center">${t.nombre}</td>\n\t\t\t\t\t\t\t\t\t<td class="text-center">${t.apellido}</td>\n\t\t\t\t\t\t\t\t\t<td class="text-center">${t.domicilio}</td>\n\t\t\t\t\t\t\t\t\t<td class="text-center">${t.correo}</td>\n\t\t\t\t\t\t\t\t\t<td class="d-flex justify-content-around">\n\t\t\t\t\t\t\t\t\t\t<button class="btn btn-warning" id="btnActualizar">Actualizar</button>\n\t\t\t\t\t\t\t\t\t\t<button class="btn btn-danger" id="btnEliminar">Eliminar</button>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t`}),$("#clientes").html(n)}}})}else e()}),$("#form").submit(n=>{if(n.preventDefault(),$("#nombre").val()&&$("#apellido").val()&&$("#domicilio").val()&&$("#correo").val()){const n={id:$("#id").val(),nombre:$("#nombre").val(),apellido:$("#apellido").val(),domicilio:$("#domicilio").val(),correo:$("#correo").val()},i={nombre:$("#nombre").val(),apellido:$("#apellido").val(),domicilio:$("#domicilio").val(),correo:$("#correo").val()},a=!1===t?"http://127.0.0.1:3000/api/agregar":"http://127.0.0.1:3000/api/actualizar",r=!1===t?i:n;$.ajax({url:a,data:r,type:"POST",success:function(n){n.error||($("#form").hide(),$("#alertaCliente").hide(),$("#form").trigger("reset"),$("#buscar").val(""),$("#btnAgregar").show(),e(),t?(Swal.fire({title:"El cliente ha sido actualizado",icon:"success",showConfirmButton:!1,timer:3e3}),$("#id").val(""),t=!1):Swal.fire({title:"El cliente ha sido agregado",icon:"success",showConfirmButton:!1,timer:3e3}))}})}else $("#alertaCliente").show(),$("#alertaCliente").text("Los campos no deben ir vacios y/o el correo no es válido")}),$(document).on("click","#btnEliminar",()=>{const t=$(this)[0].activeElement.parentElement.parentElement;Swal.fire({title:"¿Deseas eliminar ese cliente?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar"}).then(n=>{if(n.isConfirmed){const n=$(t).attr("clienteId");$.ajax({url:"http://127.0.0.1:3000/api/eliminar",data:{id:n},type:"POST",success:function(t){$("#buscar").trigger("reset"),e()}}),Swal.fire({title:"El cliente ha sido eliminado",icon:"success",showConfirmButton:!1,timer:3e3})}})}),$(document).on("click","#btnActualizar",()=>{const e=$(this)[0].activeElement.parentElement.parentElement,n=$(e).attr("clienteId");$.ajax({url:"http://127.0.0.1:3000/api/cliente",data:{id:n},type:"POST",success:function(e){if(!e.error){const n=JSON.parse(e);$("#nombre").val(n.nombre),$("#apellido").val(n.apellido),$("#domicilio").val(n.domicilio),$("#correo").val(n.correo),$("#id").val(n.id),t=!0,$("#form").show(),$("#formTitle").text("Modificar Cliente"),$("#btnAddUpd").text("Modificar")}}})})}));